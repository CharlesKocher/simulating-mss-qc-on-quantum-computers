(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    106879,       3139]
NotebookOptionsPosition[    103434,       3077]
NotebookOutlinePosition[    103774,       3092]
CellTagsIndexPosition[    103731,       3089]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"Sqrt", "[", "m", "]"}], "]"}], " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[Equal]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{"0.", " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[NotEqual]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adag", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"adagfxn", "[", 
      RowBox[{"n", ",", "m"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"adag", "[", "basissize", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", " ", "/", " ", "2."}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "+", " ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"-", "I"}], " ", 
    RowBox[{"Sqrt", "[", "2.", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "-", "  ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h0", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"n", " ", "+", " ", 
       RowBox[{"1", " ", "/", " ", "2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "0", ",", " ", 
        RowBox[{"basissize", " ", "-", " ", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", 
    RowBox[{"basissize_", ",", "g_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"h0", "[", "basissize", "]"}], " ", "-", " ", 
    RowBox[{"3", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}]}], "/", "2"}]}], " ", "+", " ", 
    RowBox[{"g", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}]}], "/", "4"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Normalize", " ", "/@", " ", 
     RowBox[{"Eigenvectors", "[", 
      RowBox[{"x", "[", "basissize", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fn", "[", 
    RowBox[{"basissize_", ",", "g_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"N", "[", 
       RowBox[{"H", "[", 
        RowBox[{"basissize", ",", "g"}], "]"}], "]"}], "]"}], "]"}], "[", 
    RowBox[{"[", "n", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toposbasis", "[", 
    RowBox[{"basissize_", ",", "evec_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", 
     RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", "evec"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xvals", "[", "basissize_", "]"}], ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", 
         RowBox[{"x", "[", "basissize", "]"}], ".", 
         RowBox[{"S", "[", "basissize", "]"}]}], ")"}], "[", 
       RowBox[{"[", "m", "]"}], "]"}], "[", 
      RowBox[{"[", "m", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "basissize"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", 
    RowBox[{"x_", ",", "g_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"g", " ", 
     RowBox[{
      RowBox[{"x", "^", "4"}], " ", "/", " ", "4"}]}], " ", "-", " ", 
    RowBox[{"x", "^", "2"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.739101192876083*^9, 3.7391012232232447`*^9}, {
   3.7391014894823775`*^9, 3.739101493966401*^9}, 3.739104206574187*^9, 
   3.739187700216096*^9, 3.740309759003357*^9},
 FontSize->24,
 CellLabel->
  "In[1754]:=",ExpressionUUID->"6df33d53-85f8-4f2b-8c25-87a9cebaef4c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qubits", "=", "5"}], ";", " ", 
  RowBox[{"dimB", "=", 
   SuperscriptBox["2", "qubits"]}], ";", " ", 
  RowBox[{"fname", "=", "\"\<double_well5q.txt\>\""}], ";", " ", 
  RowBox[{"g", "=", ".20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "  ", "=", " ", 
   RowBox[{"N", "[", 
    RowBox[{"H", "[", 
     RowBox[{"dimB", ",", "g"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "H", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "\[ImaginaryI]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[ImaginaryI]", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalIota]", " ", "=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OGpauli", " ", "=", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "Z", ",", "\[CapitalIota]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permList", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"OGpauli", ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permListString", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\"", ",", "\"\<I\>\""}], 
      "}"}], ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fname", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "fname"}], "}"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"OpenWrite", "[", "fname", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
   SuperscriptBox["4", "qubits"], " ", "\"\<in tbp basis set\\n\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "permList", "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"permList", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalSigma]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", 
            RowBox[{"H", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}], "/", 
         SuperscriptBox["2", "qubits"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"permListString", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", 
            RowBox[{"StringReverse", "[", "b", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", "\"\<\\n\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Write", "[", 
           RowBox[{"s", ",", "a"}], "]"}], ";"}], "\[IndentingNewLine]", 
         ")"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"j", "/", 
      SuperscriptBox["4", "qubits"]}], "*", "100"}], "//", "N"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "s", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7391012388161383`*^9, 3.739101294303445*^9}, {
  3.739101496428015*^9, 3.7391015216259565`*^9}, {3.739101584389717*^9, 
  3.7391015923909616`*^9}, {3.739104211033812*^9, 3.739104216846445*^9}, {
  3.7391877049667206`*^9, 3.7391877076435366`*^9}, {3.739187755872968*^9, 
  3.739187757887182*^9}, {3.7403097662028017`*^9, 3.7403097936957445`*^9}},
 FontSize->24,
 CellLabel->
  "In[1768]:=",ExpressionUUID->"dfbaedf4-1591-475f-b01b-d3478bd7d844"],

Cell[BoxData[
 RowBox[{"1024", " ", "\<\"in tbp basis set\\n\"\>"}]], "Print",
 CellChangeTimes->{3.7391013066611023`*^9, 3.739101603790229*^9, 
  3.7391042411295757`*^9, 3.7391877151717763`*^9, 3.7391877663164215`*^9, 
  3.7403098164708757`*^9},
 CellLabel->
  "During evaluation of \
In[1768]:=",ExpressionUUID->"139248a0-e289-45f4-9f27-0d646fa14f35"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"Sqrt", "[", "m", "]"}], "]"}], " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[Equal]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{"0.", " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[NotEqual]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adag", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"adagfxn", "[", 
      RowBox[{"n", ",", "m"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"adag", "[", "basissize", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", " ", "/", " ", "2."}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "+", " ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"-", "I"}], " ", 
    RowBox[{"Sqrt", "[", "2.", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "-", "  ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h0", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"n", " ", "+", " ", 
       RowBox[{"1", " ", "/", " ", "2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "0", ",", " ", 
        RowBox[{"basissize", " ", "-", " ", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", 
    RowBox[{"basissize_", ",", "g_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"h0", "[", "basissize", "]"}], " ", "+", " ", 
    RowBox[{"g", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}]}], "/", "4"}]}]}]}], 
  ";"}]}], "Input",
 CellLabel->
  "In[1557]:=",ExpressionUUID->"724fb65a-6ac8-4a35-beee-8df94dfb6336"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qubits", "=", "4"}], ";", " ", 
  RowBox[{"dimB", "=", 
   SuperscriptBox["2", "qubits"]}], ";", " ", 
  RowBox[{"fname", "=", "\"\<anharmonic_NR.txt\>\""}], ";", " ", 
  RowBox[{"g", "=", ".275"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "  ", "=", " ", 
   RowBox[{"N", "[", 
    RowBox[{"10", "  ", 
     RowBox[{"H", "[", 
      RowBox[{"dimB", ",", "g"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "H", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "\[ImaginaryI]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[ImaginaryI]", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalIota]", " ", "=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OGpauli", " ", "=", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "Z", ",", "\[CapitalIota]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permList", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"OGpauli", ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permListString", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\"", ",", "\"\<I\>\""}], 
      "}"}], ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fname", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "fname"}], "}"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"OpenWrite", "[", "fname", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
   SuperscriptBox["4", "qubits"], " ", "\"\<in tbp basis set\\n\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "permList", "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"permList", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalSigma]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", 
            RowBox[{"H", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}], "/", 
         SuperscriptBox["2", "qubits"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"permListString", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", 
            RowBox[{"StringReverse", "[", "b", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", "\"\<\\n\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Write", "[", 
           RowBox[{"s", ",", "a"}], "]"}], ";"}], "\[IndentingNewLine]", 
         ")"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"j", "/", 
      SuperscriptBox["4", "qubits"]}], "*", "100"}], "//", "N"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "s", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.740910546672437*^9, 3.7409106212792573`*^9}},
 CellLabel->
  "In[1566]:=",ExpressionUUID->"7966facd-f33f-46cd-9a30-8384338f6736"],

Cell[BoxData[
 RowBox[{"256", " ", "\<\"in tbp basis set\\n\"\>"}]], "Print",
 CellChangeTimes->{{3.740910584562956*^9, 3.7409106102777677`*^9}, {
  3.740910641358821*^9, 3.7409106577199607`*^9}},
 CellLabel->
  "During evaluation of \
In[1566]:=",ExpressionUUID->"8c80eb96-8f05-4e25-bfd0-baf6e88fe0d9"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"Sqrt", "[", "m", "]"}], "]"}], " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[Equal]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{"0.", " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[NotEqual]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adag", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"adagfxn", "[", 
      RowBox[{"n", ",", "m"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"adag", "[", "basissize", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", " ", "/", " ", "2."}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "+", " ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"-", "I"}], " ", 
    RowBox[{"Sqrt", "[", "2.", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "-", "  ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h0", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"n", " ", "+", " ", 
       RowBox[{"1", " ", "/", " ", "2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "0", ",", " ", 
        RowBox[{"basissize", " ", "-", " ", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"h0", "[", "basissize", "]"}], ",", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}], " ", "+", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "basissize", "]"}], "/", 
       RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", "b", "]"}], ".", "b"}], " ", "-", 
       " ", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "2", "]"}], "/", "2"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Normalize", " ", "/@", " ", 
     RowBox[{"Eigenvectors", "[", 
      RowBox[{"x", "[", "basissize", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fn", "[", 
    RowBox[{"basissize_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"N", "[", 
       RowBox[{"H", "[", "basissize", "]"}], "]"}], "]"}], "]"}], "[", 
    RowBox[{"[", "n", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toposbasis", "[", 
    RowBox[{"basissize_", ",", "evec_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", 
     RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", "evec"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xvals", "[", "basissize_", "]"}], ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", 
         RowBox[{"x", "[", "basissize", "]"}], ".", 
         RowBox[{"S", "[", "basissize", "]"}]}], ")"}], "[", 
       RowBox[{"[", "m", "]"}], "]"}], "[", 
      RowBox[{"[", "m", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "basissize"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[2931]:=",ExpressionUUID->"885ad665-6c20-4679-bfe9-463c0194084b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qubits", "=", "4"}], ";", " ", 
  RowBox[{"dimB", "=", 
   SuperscriptBox["2", "qubits"]}], ";", " ", 
  RowBox[{"fname", "=", "\"\<harmonic_fermion.txt\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "  ", "=", " ", 
   RowBox[{"N", "[", " ", 
    RowBox[{"H", "[", 
     RowBox[{"dimB", "/", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "H", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "\[ImaginaryI]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[ImaginaryI]", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalIota]", " ", "=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OGpauli", " ", "=", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "Z", ",", "\[CapitalIota]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permList", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"OGpauli", ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permListString", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\"", ",", "\"\<I\>\""}], 
      "}"}], ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fname", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "fname"}], "}"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"OpenWrite", "[", "fname", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
   SuperscriptBox["4", "qubits"], " ", "\"\<in tbp basis set\\n\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "permList", "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"permList", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalSigma]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", 
            RowBox[{"H", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}], "/", 
         SuperscriptBox["2", "qubits"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"permListString", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", 
            RowBox[{"StringReverse", "[", "b", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", "\"\<\\n\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Write", "[", 
           RowBox[{"s", ",", "a"}], "]"}], ";"}], "\[IndentingNewLine]", 
         ")"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"j", "/", 
      SuperscriptBox["4", "qubits"]}], "*", "100"}], "//", "N"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "s", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7413671641617146`*^9, 3.7413671790835686`*^9}, {
  3.7413673285651183`*^9, 3.7413673292911596`*^9}},
 CellLabel->
  "In[2945]:=",ExpressionUUID->"4bf0873b-ce04-47a7-ac46-13f5a4581411"],

Cell[BoxData[
 RowBox[{"256", " ", "\<\"in tbp basis set\\n\"\>"}]], "Print",
 CellChangeTimes->{3.741367375484802*^9},
 CellLabel->
  "During evaluation of \
In[2945]:=",ExpressionUUID->"01ed987f-aeb4-451b-9a9d-e884349f2016"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"Sqrt", "[", "m", "]"}], "]"}], " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[Equal]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{"0.", " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[NotEqual]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adag", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"adagfxn", "[", 
      RowBox[{"n", ",", "m"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"adag", "[", "basissize", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", " ", "/", " ", "2."}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "+", " ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"-", "I"}], " ", 
    RowBox[{"Sqrt", "[", "2.", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "-", "  ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h0", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"n", " ", "+", " ", 
       RowBox[{"1", " ", "/", " ", "2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "0", ",", " ", 
        RowBox[{"basissize", " ", "-", " ", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "[", "basissize_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"h0", "[", "basissize", "]"}], ",", 
      RowBox[{"IdentityMatrix", "[", "basissize", "]"}]}], "]"}]}], " ", "+", 
   " ", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "basissize", "]"}], ",", 
     RowBox[{"h0", "[", "basissize", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Normalize", " ", "/@", " ", 
     RowBox[{"Eigenvectors", "[", 
      RowBox[{"x", "[", "basissize", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fn", "[", 
    RowBox[{"basissize_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"N", "[", 
       RowBox[{"H", "[", "basissize", "]"}], "]"}], "]"}], "]"}], "[", 
    RowBox[{"[", "n", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toposbasis", "[", 
    RowBox[{"basissize_", ",", "evec_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", 
     RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", "evec"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xvals", "[", "basissize_", "]"}], ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", 
         RowBox[{"x", "[", "basissize", "]"}], ".", 
         RowBox[{"S", "[", "basissize", "]"}]}], ")"}], "[", 
       RowBox[{"[", "m", "]"}], "]"}], "[", 
      RowBox[{"[", "m", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "basissize"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", "x_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"x", "^", "2"}], "/", "2"}]}], ";"}]}], "Input",
 CellLabel->"In[63]:=",ExpressionUUID->"f1c16ba9-a3f9-4a9e-84df-f58bd80df734"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qubits", "=", "4"}], ";", " ", 
  RowBox[{"dimB", "=", 
   SuperscriptBox["2", "qubits"]}], ";", " ", 
  RowBox[{"fname", "=", "\"\<doubled_harmonic.txt\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "  ", "=", " ", 
   RowBox[{"N", "[", " ", 
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"Sqrt", "[", "dimB", "]"}], "]"}], ".", 
     RowBox[{"H", "[", 
      RowBox[{"Sqrt", "[", "dimB", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "H", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "\[ImaginaryI]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[ImaginaryI]", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalIota]", " ", "=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OGpauli", " ", "=", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "Z", ",", "\[CapitalIota]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permList", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"OGpauli", ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permListString", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\"", ",", "\"\<I\>\""}], 
      "}"}], ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fname", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "fname"}], "}"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"OpenWrite", "[", "fname", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
   SuperscriptBox["4", "qubits"], " ", "\"\<in tbp basis set\\n\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "permList", "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"permList", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalSigma]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", 
            RowBox[{"H", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}], "/", 
         SuperscriptBox["2", "qubits"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"permListString", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", 
            RowBox[{"StringReverse", "[", "b", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", "\"\<\\n\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Write", "[", 
           RowBox[{"s", ",", "a"}], "]"}], ";"}], "\[IndentingNewLine]", 
         ")"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"j", "/", 
      SuperscriptBox["4", "qubits"]}], "*", "100"}], "//", "N"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "s", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.741517514683263*^9, 3.741517532797299*^9}, {
  3.741517565208153*^9, 3.741517612592863*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"6b9f3fc0-e621-42c9-a4a5-e4908d625356"],

Cell[BoxData[
 RowBox[{"256", " ", "\<\"in tbp basis set\\n\"\>"}]], "Print",
 CellChangeTimes->{
  3.741517570842475*^9, {3.741517615259015*^9, 3.741517622436426*^9}},
 CellLabel->
  "During evaluation of \
In[77]:=",ExpressionUUID->"22871366-e647-4f52-a915-9bd9c409821d"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"Sqrt", "[", "m", "]"}], "]"}], " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[Equal]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{"0.", " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[NotEqual]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adag", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"adagfxn", "[", 
      RowBox[{"n", ",", "m"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"adag", "[", "basissize", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", " ", "/", " ", "2."}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "+", " ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"-", "I"}], " ", 
    RowBox[{"Sqrt", "[", "2.", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "-", "  ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h0", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Reverse", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"n", " ", "+", " ", 
        RowBox[{"1", " ", "/", " ", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", " ", "0", ",", " ", 
         RowBox[{"basissize", " ", "-", " ", "1"}]}], "}"}]}], "]"}], "]"}], 
    "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "[", "basissize_", "]"}], ":=", " ", 
  RowBox[{"h0", "[", "basissize", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Normalize", " ", "/@", " ", 
     RowBox[{"Eigenvectors", "[", 
      RowBox[{"x", "[", "basissize", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fn", "[", 
    RowBox[{"basissize_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"N", "[", 
       RowBox[{"H", "[", "basissize", "]"}], "]"}], "]"}], "]"}], "[", 
    RowBox[{"[", "n", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toposbasis", "[", 
    RowBox[{"basissize_", ",", "evec_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", 
     RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", "evec"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xvals", "[", "basissize_", "]"}], ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", 
         RowBox[{"x", "[", "basissize", "]"}], ".", 
         RowBox[{"S", "[", "basissize", "]"}]}], ")"}], "[", 
       RowBox[{"[", "m", "]"}], "]"}], "[", 
      RowBox[{"[", "m", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "basissize"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", "x_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"x", "^", "2"}], "/", "2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7415308482960863`*^9, 3.7415308670383964`*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"c154199a-da3e-459e-b950-7d37820399d9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qubits", "=", "3"}], ";", " ", 
  RowBox[{"dimB", "=", 
   SuperscriptBox["2", "qubits"]}], ";", " ", 
  RowBox[{"fname", "=", "\"\<harmonic_pi_measurement.txt\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "  ", "=", " ", 
   RowBox[{"N", "[", " ", 
    RowBox[{"H", "[", "dimB", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "H", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "\[ImaginaryI]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[ImaginaryI]", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalIota]", " ", "=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OGpauli", " ", "=", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "Z", ",", "\[CapitalIota]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permList", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"OGpauli", ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permListString", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\"", ",", "\"\<I\>\""}], 
      "}"}], ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fname", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "fname"}], "}"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"OpenWrite", "[", "fname", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
   SuperscriptBox["4", "qubits"], " ", "\"\<in tbp basis set\\n\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "permList", "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"permList", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalSigma]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", 
            RowBox[{"H", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}], "/", 
         SuperscriptBox["2", "qubits"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"permListString", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", 
            RowBox[{"StringReverse", "[", "b", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", "\"\<\\n\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Write", "[", 
           RowBox[{"s", ",", "a"}], "]"}], ";"}], "\[IndentingNewLine]", 
         ")"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"j", "/", 
      SuperscriptBox["4", "qubits"]}], "*", "100"}], "//", "N"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "s", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7415308904233294`*^9, 3.7415309010207825`*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"9f837ba3-b5b4-435a-ab38-964d60aa0b91"],

Cell[BoxData[
 RowBox[{"64", " ", "\<\"in tbp basis set\\n\"\>"}]], "Print",
 CellChangeTimes->{3.741530934121968*^9},
 CellLabel->
  "During evaluation of \
In[121]:=",ExpressionUUID->"5652ed11-82eb-45c3-a441-8fc04cac6086"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"Sqrt", "[", "m", "]"}], "]"}], " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[Equal]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{"0.", " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[NotEqual]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adag", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"adagfxn", "[", 
      RowBox[{"n", ",", "m"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"adag", "[", "basissize", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", " ", "/", " ", "2."}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "+", " ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"-", "I"}], " ", 
    RowBox[{"Sqrt", "[", "2.", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "-", "  ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h0", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"n", " ", "+", " ", 
       RowBox[{"1", " ", "/", " ", "2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "0", ",", " ", 
        RowBox[{"basissize", " ", "-", " ", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "[", 
    RowBox[{"basissize_", ",", "g_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"h0", "[", "basissize", "]"}], " ", "+", " ", 
    RowBox[{"g", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}]}], "/", "4"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "[", 
   RowBox[{"basissize_", ",", "g_"}], "]"}], ":=", "  ", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"basissize", ",", "g"}], "]"}], ",", 
      RowBox[{"IdentityMatrix", "[", "basissize", "]"}]}], "]"}]}], " ", "+", 
   " ", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "basissize", "]"}], ",", 
     RowBox[{"G", "[", 
      RowBox[{"basissize", ",", "g"}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Normalize", " ", "/@", " ", 
       RowBox[{"Eigenvectors", "[", 
        RowBox[{"x", "[", "basissize", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Normalize", " ", "/@", " ", 
       RowBox[{"Eigenvectors", "[", 
        RowBox[{"x", "[", "basissize", "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fn", "[", 
    RowBox[{"basissize_", ",", "g_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"N", "[", 
       RowBox[{"H", "[", 
        RowBox[{"basissize", ",", "g"}], "]"}], "]"}], "]"}], "]"}], "[", 
    RowBox[{"[", "n", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toposbasis", "[", 
    RowBox[{"basissize_", ",", "evec_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", 
     RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", "evec"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xvals", "[", "basissize_", "]"}], ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", 
         RowBox[{"x", "[", "basissize", "]"}], ".", 
         RowBox[{"S", "[", "basissize", "]"}]}], ")"}], "[", 
       RowBox[{"[", "m", "]"}], "]"}], "[", 
      RowBox[{"[", "m", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "basissize"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[625]:=",ExpressionUUID->"9b4c6cf5-7376-45ce-8a0c-7e330887deca"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qubits", "=", "4"}], ";", " ", 
  RowBox[{"dimB", "=", 
   SuperscriptBox["2", "qubits"]}], ";", " ", 
  RowBox[{"fname", "=", "\"\<doubled_anharmonic_small.txt\>\""}], ";", " ", 
  RowBox[{"g", " ", "=", " ", ".275"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "  ", "=", " ", 
   RowBox[{"N", "[", " ", 
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{
       RowBox[{"Sqrt", "[", "dimB", "]"}], ",", "g"}], "]"}], ".", 
     RowBox[{"H", "[", 
      RowBox[{
       RowBox[{"Sqrt", "[", "dimB", "]"}], ",", "g"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "H", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "\[ImaginaryI]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[ImaginaryI]", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalIota]", " ", "=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OGpauli", " ", "=", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "Z", ",", "\[CapitalIota]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permList", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"OGpauli", ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permListString", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\"", ",", "\"\<I\>\""}], 
      "}"}], ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fname", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "fname"}], "}"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"OpenWrite", "[", "fname", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
   SuperscriptBox["4", "qubits"], " ", "\"\<in tbp basis set\\n\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "permList", "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"permList", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalSigma]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", 
            RowBox[{"H", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}], "/", 
         SuperscriptBox["2", "qubits"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"permListString", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", 
            RowBox[{"StringReverse", "[", "b", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", "\"\<\\n\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Write", "[", 
           RowBox[{"s", ",", "a"}], "]"}], ";"}], "\[IndentingNewLine]", 
         ")"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"j", "/", 
      SuperscriptBox["4", "qubits"]}], "*", "100"}], "//", "N"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "s", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7416224148365655`*^9, 3.74162244746756*^9}, {
  3.741688832934992*^9, 3.741688833515025*^9}, {3.7416980159474015`*^9, 
  3.7416980390743237`*^9}},
 CellLabel->
  "In[639]:=",ExpressionUUID->"a7580264-4b46-4214-988b-8874c9b92242"],

Cell[BoxData[
 RowBox[{"256", " ", "\<\"in tbp basis set\\n\"\>"}]], "Print",
 CellChangeTimes->{3.741688841595487*^9, 3.741698025017453*^9, 
  3.741698071721487*^9},
 CellLabel->
  "During evaluation of \
In[639]:=",ExpressionUUID->"0863f9ea-bcdf-4b8b-a3f5-ed50461a9def"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"Sqrt", "[", "m", "]"}], "]"}], " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[Equal]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{"0.", " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[NotEqual]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adag", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"adagfxn", "[", 
      RowBox[{"n", ",", "m"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"adag", "[", "basissize", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", " ", "/", " ", "2."}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "+", " ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"-", "I"}], " ", 
    RowBox[{"Sqrt", "[", "2.", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "-", "  ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h0", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"n", " ", "+", " ", 
       RowBox[{"1", " ", "/", " ", "2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "0", ",", " ", 
        RowBox[{"basissize", " ", "-", " ", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "[", 
    RowBox[{"basissize_", ",", "g_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"h0", "[", "basissize", "]"}], " ", "-", " ", 
    RowBox[{"3", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}]}], "/", "2"}]}], " ", "+", " ", 
    RowBox[{"g", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}]}], "/", "4"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", 
    RowBox[{"basissize_", ",", "g_"}], "]"}], ":=", "  ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"G", "[", 
        RowBox[{"basissize", ",", "g"}], "]"}], ",", 
       RowBox[{"IdentityMatrix", "[", "basissize", "]"}]}], "]"}]}], " ", "+",
     " ", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "basissize", "]"}], ",", 
      RowBox[{"G", "[", 
       RowBox[{"basissize", ",", "g"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Normalize", " ", "/@", " ", 
       RowBox[{"Eigenvectors", "[", 
        RowBox[{"x", "[", "basissize", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Normalize", " ", "/@", " ", 
       RowBox[{"Eigenvectors", "[", 
        RowBox[{"x", "[", "basissize", "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fn", "[", 
    RowBox[{"basissize_", ",", "g_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"N", "[", 
       RowBox[{"H", "[", 
        RowBox[{"basissize", ",", "g"}], "]"}], "]"}], "]"}], "]"}], "[", 
    RowBox[{"[", "n", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toposbasis", "[", 
    RowBox[{"basissize_", ",", "evec_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", 
     RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", "evec"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xvals", "[", "basissize_", "]"}], ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", 
         RowBox[{"x", "[", "basissize", "]"}], ".", 
         RowBox[{"S", "[", "basissize", "]"}]}], ")"}], "[", 
       RowBox[{"[", "m", "]"}], "]"}], "[", 
      RowBox[{"[", "m", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "basissize"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", 
    RowBox[{"x_", ",", "g_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"g", " ", 
     RowBox[{
      RowBox[{"x", "^", "4"}], " ", "/", " ", "4"}]}], " ", "-", " ", 
    RowBox[{"x", "^", "2"}]}]}], ";"}]}], "Input",
 CellLabel->
  "In[596]:=",ExpressionUUID->"8b006829-da40-4f41-bb31-176e4b87c03b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qubits", "=", "4"}], ";", " ", 
  RowBox[{"dimB", "=", 
   SuperscriptBox["2", "qubits"]}], ";", " ", 
  RowBox[{"fname", "=", "\"\<doubled_double_well_small.txt\>\""}], ";", " ", 
  RowBox[{"g", " ", "=", " ", ".15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "  ", "=", " ", 
   RowBox[{"N", "[", " ", 
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{
       RowBox[{"Sqrt", "[", "dimB", "]"}], ",", "g"}], "]"}], ".", 
     RowBox[{"H", "[", 
      RowBox[{
       RowBox[{"Sqrt", "[", "dimB", "]"}], ",", "g"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "H", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "\[ImaginaryI]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[ImaginaryI]", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalIota]", " ", "=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OGpauli", " ", "=", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "Z", ",", "\[CapitalIota]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permList", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"OGpauli", ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permListString", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\"", ",", "\"\<I\>\""}], 
      "}"}], ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fname", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "fname"}], "}"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"OpenWrite", "[", "fname", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
   SuperscriptBox["4", "qubits"], " ", "\"\<in tbp basis set\\n\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "permList", "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"permList", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalSigma]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", 
            RowBox[{"H", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}], "/", 
         SuperscriptBox["2", "qubits"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"permListString", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", 
            RowBox[{"StringReverse", "[", "b", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", "\"\<\\n\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Write", "[", 
           RowBox[{"s", ",", "a"}], "]"}], ";"}], "\[IndentingNewLine]", 
         ")"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"j", "/", 
      SuperscriptBox["4", "qubits"]}], "*", "100"}], "//", "N"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.741691556057401*^9, 3.7416915619371376`*^9}, {
  3.7416980320106883`*^9, 3.741698047073965*^9}},
 CellLabel->
  "In[611]:=",ExpressionUUID->"501efd23-3adb-4064-9f35-f1b1293cded9"],

Cell[BoxData[
 RowBox[{"256", " ", "\<\"in tbp basis set\\n\"\>"}]], "Print",
 CellChangeTimes->{3.7416915826885405`*^9, 3.741698051446788*^9},
 CellLabel->
  "During evaluation of \
In[611]:=",ExpressionUUID->"690ad3f3-2ea0-4c57-ad13-5d9ba0a8e5da"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"Sqrt", "[", "m", "]"}], "]"}], " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[Equal]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{"0.", " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[NotEqual]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adag", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"adagfxn", "[", 
      RowBox[{"n", ",", "m"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"adag", "[", "basissize", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", " ", "/", " ", "2."}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "+", " ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"-", "I"}], " ", 
    RowBox[{"Sqrt", "[", "2.", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "-", "  ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h0", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"n", " ", "+", " ", 
       RowBox[{"1", " ", "/", " ", "2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "0", ",", " ", 
        RowBox[{"basissize", " ", "-", " ", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "[", "basissize_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "basissize", "]"}], ".", 
     RowBox[{"p", "[", "basissize", "]"}]}], "/", "4"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"x", "[", "basissize", "]"}], ".", 
    RowBox[{"x", "[", "basissize", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "[", "basissize_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"G", "[", "basissize", "]"}], ",", 
      RowBox[{"IdentityMatrix", "[", "basissize", "]"}]}], "]"}]}], " ", "+", 
   " ", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "basissize", "]"}], ",", 
     RowBox[{"G", "[", "basissize", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Normalize", " ", "/@", " ", 
     RowBox[{"Eigenvectors", "[", 
      RowBox[{"x", "[", "basissize", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fn", "[", 
    RowBox[{"basissize_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"N", "[", 
       RowBox[{"H", "[", "basissize", "]"}], "]"}], "]"}], "]"}], "[", 
    RowBox[{"[", "n", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toposbasis", "[", 
    RowBox[{"basissize_", ",", "evec_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", 
     RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", "evec"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xvals", "[", "basissize_", "]"}], ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", 
         RowBox[{"x", "[", "basissize", "]"}], ".", 
         RowBox[{"S", "[", "basissize", "]"}]}], ")"}], "[", 
       RowBox[{"[", "m", "]"}], "]"}], "[", 
      RowBox[{"[", "m", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "basissize"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", "x_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"x", "^", "2"}], "/", "2"}]}], ";"}]}], "Input",
 CellLabel->
  "In[670]:=",ExpressionUUID->"800da84e-dfd9-4cad-931b-0102d820629c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qubits", "=", "4"}], ";", " ", 
  RowBox[{"dimB", "=", 
   SuperscriptBox["2", "qubits"]}], ";", " ", 
  RowBox[{"fname", "=", "\"\<doubled_harmonic_fixed.txt\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "  ", "=", " ", 
   RowBox[{"N", "[", " ", 
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"Sqrt", "[", "dimB", "]"}], "]"}], ".", 
     RowBox[{"H", "[", 
      RowBox[{"Sqrt", "[", "dimB", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "H", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "\[ImaginaryI]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[ImaginaryI]", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalIota]", " ", "=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OGpauli", " ", "=", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "Z", ",", "\[CapitalIota]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permList", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"OGpauli", ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permListString", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\"", ",", "\"\<I\>\""}], 
      "}"}], ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fname", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "fname"}], "}"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"OpenWrite", "[", "fname", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
   SuperscriptBox["4", "qubits"], " ", "\"\<in tbp basis set\\n\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "permList", "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"permList", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalSigma]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", 
            RowBox[{"H", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}], "/", 
         SuperscriptBox["2", "qubits"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"permListString", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", 
            RowBox[{"StringReverse", "[", "b", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", "\"\<\\n\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Write", "[", 
           RowBox[{"s", ",", "a"}], "]"}], ";"}], "\[IndentingNewLine]", 
         ")"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"j", "/", 
      SuperscriptBox["4", "qubits"]}], "*", "100"}], "//", "N"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "s", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.741709904459676*^9, 3.7417099056090813`*^9}},
 CellLabel->
  "In[685]:=",ExpressionUUID->"fee83685-b9d6-420e-998e-80741aa3ddef"],

Cell[BoxData[
 RowBox[{"256", " ", "\<\"in tbp basis set\\n\"\>"}]], "Print",
 CellChangeTimes->{3.7417099232708044`*^9},
 CellLabel->
  "During evaluation of \
In[685]:=",ExpressionUUID->"a71fe4db-dae5-4aaf-bf40-c6bcc31bddaa"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"Sqrt", "[", "m", "]"}], "]"}], " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[Equal]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{"0.", " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[NotEqual]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adag", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"adagfxn", "[", 
      RowBox[{"n", ",", "m"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"adag", "[", "basissize", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", " ", "/", " ", "2."}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "+", " ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"-", "I"}], " ", 
    RowBox[{"Sqrt", "[", "2.", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "-", "  ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h0", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"n", " ", "+", " ", 
       RowBox[{"1", " ", "/", " ", "2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "0", ",", " ", 
        RowBox[{"basissize", " ", "-", " ", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "[", 
    RowBox[{"basissize_", ",", "g_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", "basissize", "]"}], ".", 
      RowBox[{"p", "[", "basissize", "]"}]}], "/", "4"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"x", "[", "basissize", "]"}], ".", 
     RowBox[{"x", "[", "basissize", "]"}]}], " ", "+", " ", 
    RowBox[{"g", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}]}], "/", "4"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", 
    RowBox[{"basissize_", ",", "g_"}], "]"}], ":=", "  ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"G", "[", 
        RowBox[{"basissize", ",", "g"}], "]"}], ",", 
       RowBox[{"IdentityMatrix", "[", "basissize", "]"}]}], "]"}]}], " ", "+",
     " ", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "basissize", "]"}], ",", 
      RowBox[{"G", "[", 
       RowBox[{"basissize", ",", "g"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Normalize", " ", "/@", " ", 
       RowBox[{"Eigenvectors", "[", 
        RowBox[{"x", "[", "basissize", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Normalize", " ", "/@", " ", 
       RowBox[{"Eigenvectors", "[", 
        RowBox[{"x", "[", "basissize", "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fn", "[", 
    RowBox[{"basissize_", ",", "g_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"N", "[", 
       RowBox[{"H", "[", 
        RowBox[{"basissize", ",", "g"}], "]"}], "]"}], "]"}], "]"}], "[", 
    RowBox[{"[", "n", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toposbasis", "[", 
    RowBox[{"basissize_", ",", "evec_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", 
     RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", "evec"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xvals", "[", "basissize_", "]"}], ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", 
         RowBox[{"x", "[", "basissize", "]"}], ".", 
         RowBox[{"S", "[", "basissize", "]"}]}], ")"}], "[", 
       RowBox[{"[", "m", "]"}], "]"}], "[", 
      RowBox[{"[", "m", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "basissize"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[700]:=",ExpressionUUID->"6c2a0814-c4d6-4b62-9bef-aa934a306d3c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qubits", "=", "4"}], ";", " ", 
  RowBox[{"dimB", "=", 
   SuperscriptBox["2", "qubits"]}], ";", " ", 
  RowBox[{"fname", "=", "\"\<doubled_anharmonic_fixed.txt\>\""}], ";", " ", 
  RowBox[{"g", " ", "=", " ", ".275"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "  ", "=", " ", 
   RowBox[{"N", "[", " ", 
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{
       RowBox[{"Sqrt", "[", "dimB", "]"}], ",", "g"}], "]"}], ".", 
     RowBox[{"H", "[", 
      RowBox[{
       RowBox[{"Sqrt", "[", "dimB", "]"}], ",", "g"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "H", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "\[ImaginaryI]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[ImaginaryI]", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalIota]", " ", "=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OGpauli", " ", "=", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "Z", ",", "\[CapitalIota]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permList", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"OGpauli", ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permListString", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\"", ",", "\"\<I\>\""}], 
      "}"}], ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fname", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "fname"}], "}"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"OpenWrite", "[", "fname", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
   SuperscriptBox["4", "qubits"], " ", "\"\<in tbp basis set\\n\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "permList", "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"permList", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalSigma]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", 
            RowBox[{"H", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}], "/", 
         SuperscriptBox["2", "qubits"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"permListString", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", 
            RowBox[{"StringReverse", "[", "b", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", "\"\<\\n\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Write", "[", 
           RowBox[{"s", ",", "a"}], "]"}], ";"}], "\[IndentingNewLine]", 
         ")"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"j", "/", 
      SuperscriptBox["4", "qubits"]}], "*", "100"}], "//", "N"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "s", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7417101450854845`*^9, 3.7417101458664904`*^9}},
 CellLabel->
  "In[714]:=",ExpressionUUID->"6fb62891-67ad-418d-846b-6e15a0468aec"],

Cell[BoxData[
 RowBox[{"256", " ", "\<\"in tbp basis set\\n\"\>"}]], "Print",
 CellChangeTimes->{3.7417101495987115`*^9},
 CellLabel->
  "During evaluation of \
In[714]:=",ExpressionUUID->"8f06159b-a33c-4f66-b914-39ab4aa54a80"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"Sqrt", "[", "m", "]"}], "]"}], " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[Equal]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adagfxn", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{"0.", " ", "/;", " ", 
    RowBox[{
     RowBox[{"m", "-", "n"}], " ", "\[NotEqual]", " ", "1"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adag", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"adagfxn", "[", 
      RowBox[{"n", ",", "m"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"basissize", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"ConjugateTranspose", "[", 
    RowBox[{"adag", "[", "basissize", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", " ", "/", " ", "2."}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "+", " ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"-", "I"}], " ", 
    RowBox[{"Sqrt", "[", "2.", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", "[", "basissize", "]"}], " ", "-", "  ", 
      RowBox[{"adag", "[", "basissize", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h0", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"n", " ", "+", " ", 
       RowBox[{"1", " ", "/", " ", "2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "0", ",", " ", 
        RowBox[{"basissize", " ", "-", " ", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "[", 
    RowBox[{"basissize_", ",", "g_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", "basissize", "]"}], ".", 
      RowBox[{"p", "[", "basissize", "]"}]}], "/", "4"}], " ", "-", "  ", 
    RowBox[{
     RowBox[{"x", "[", "basissize", "]"}], ".", 
     RowBox[{"x", "[", "basissize", "]"}]}], "+", " ", 
    RowBox[{"g", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}], ".", 
       RowBox[{"x", "[", "basissize", "]"}]}], "/", "4"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", 
    RowBox[{"basissize_", ",", "g_"}], "]"}], ":=", "  ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"G", "[", 
        RowBox[{"basissize", ",", "g"}], "]"}], ",", 
       RowBox[{"IdentityMatrix", "[", "basissize", "]"}]}], "]"}]}], " ", "+",
     " ", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "basissize", "]"}], ",", 
      RowBox[{"G", "[", 
       RowBox[{"basissize", ",", "g"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", "basissize_", "]"}], " ", ":=", " ", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Normalize", " ", "/@", " ", 
       RowBox[{"Eigenvectors", "[", 
        RowBox[{"x", "[", "basissize", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Normalize", " ", "/@", " ", 
       RowBox[{"Eigenvectors", "[", 
        RowBox[{"x", "[", "basissize", "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fn", "[", 
    RowBox[{"basissize_", ",", "g_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Eigenvalues", "[", 
      RowBox[{"N", "[", 
       RowBox[{"H", "[", 
        RowBox[{"basissize", ",", "g"}], "]"}], "]"}], "]"}], "]"}], "[", 
    RowBox[{"[", "n", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toposbasis", "[", 
    RowBox[{"basissize_", ",", "evec_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", 
     RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", "evec"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xvals", "[", "basissize_", "]"}], ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"S", "[", "basissize", "]"}], "]"}], ".", 
         RowBox[{"x", "[", "basissize", "]"}], ".", 
         RowBox[{"S", "[", "basissize", "]"}]}], ")"}], "[", 
       RowBox[{"[", "m", "]"}], "]"}], "[", 
      RowBox[{"[", "m", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "basissize"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", 
    RowBox[{"x_", ",", "g_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"g", " ", 
     RowBox[{
      RowBox[{"x", "^", "4"}], " ", "/", " ", "4"}]}], " ", "-", " ", 
    RowBox[{"x", "^", "2"}]}]}], ";"}]}], "Input",
 CellLabel->
  "In[729]:=",ExpressionUUID->"cae2a2dd-4f50-408a-939a-e97502f25355"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qubits", "=", "4"}], ";", " ", 
  RowBox[{"dimB", "=", 
   SuperscriptBox["2", "qubits"]}], ";", " ", 
  RowBox[{"fname", "=", "\"\<doubled_double_well_fixed.txt\>\""}], ";", " ", 
  RowBox[{"g", " ", "=", " ", ".15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "  ", "=", " ", 
   RowBox[{"N", "[", " ", 
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{
       RowBox[{"Sqrt", "[", "dimB", "]"}], ",", "g"}], "]"}], ".", 
     RowBox[{"H", "[", 
      RowBox[{
       RowBox[{"Sqrt", "[", "dimB", "]"}], ",", "g"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", "H", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "\[ImaginaryI]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[ImaginaryI]", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalIota]", " ", "=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OGpauli", " ", "=", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "Z", ",", "\[CapitalIota]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permList", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{"OGpauli", ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permListString", "=", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\"", ",", "\"\<I\>\""}], 
      "}"}], ",", 
     RowBox[{"{", "qubits", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fname", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "fname"}], "}"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"OpenWrite", "[", "fname", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
   SuperscriptBox["4", "qubits"], " ", "\"\<in tbp basis set\\n\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "permList", "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalSigma]", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"KroneckerProduct", ",", 
         RowBox[{"permList", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalSigma]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", 
            RowBox[{"H", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "i"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}], "/", 
         SuperscriptBox["2", "qubits"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"a", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"permListString", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", 
            RowBox[{"StringReverse", "[", "b", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"s", ",", "\"\<\\n\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Write", "[", 
           RowBox[{"s", ",", "a"}], "]"}], ";"}], "\[IndentingNewLine]", 
         ")"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"j", "/", 
      SuperscriptBox["4", "qubits"]}], "*", "100"}], "//", "N"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.741710237128329*^9, 3.7417102378931313`*^9}},
 CellLabel->
  "In[744]:=",ExpressionUUID->"eb0030d6-5f68-486b-b425-b3c96ff818d9"],

Cell[BoxData[
 RowBox[{"256", " ", "\<\"in tbp basis set\\n\"\>"}]], "Print",
 CellChangeTimes->{3.7417102420807533`*^9},
 CellLabel->
  "During evaluation of \
In[744]:=",ExpressionUUID->"8176031b-676f-4e38-b877-8714f78f789a"]
}, Open  ]]
},
WindowSize->{942, 962},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5215, 154, 882, "Input",ExpressionUUID->"6df33d53-85f8-4f2b-8c25-87a9cebaef4c"],
Cell[CellGroupData[{
Cell[5798, 178, 5179, 144, 980, "Input",ExpressionUUID->"dfbaedf4-1591-475f-b01b-d3478bd7d844"],
Cell[10980, 324, 353, 7, 41, "Print",ExpressionUUID->"139248a0-e289-45f4-9f27-0d646fa14f35"]
}, Open  ]],
Cell[11348, 334, 3009, 91, 181, "Input",ExpressionUUID->"724fb65a-6ac8-4a35-beee-8df94dfb6336"],
Cell[CellGroupData[{
Cell[14382, 429, 4897, 141, 535, "Input",ExpressionUUID->"7966facd-f33f-46cd-9a30-8384338f6736"],
Cell[19282, 572, 303, 6, 41, "Print",ExpressionUUID->"8c80eb96-8f05-4e25-bfd0-baf6e88fe0d9"]
}, Open  ]],
Cell[19600, 581, 4942, 148, 314, "Input",ExpressionUUID->"885ad665-6c20-4679-bfe9-463c0194084b"],
Cell[CellGroupData[{
Cell[24567, 733, 4890, 140, 535, "Input",ExpressionUUID->"4bf0873b-ce04-47a7-ac46-13f5a4581411"],
Cell[29460, 875, 226, 5, 41, "Print",ExpressionUUID->"01ed987f-aeb4-451b-9a9d-e884349f2016"]
}, Open  ]],
Cell[29701, 883, 4660, 139, 314, "Input",ExpressionUUID->"f1c16ba9-a3f9-4a9e-84df-f58bd80df734"],
Cell[CellGroupData[{
Cell[34386, 1026, 4984, 143, 535, "Input",ExpressionUUID->"6b9f3fc0-e621-42c9-a4a5-e4908d625356"],
Cell[39373, 1171, 273, 6, 41, "Print",ExpressionUUID->"22871366-e647-4f52-a915-9bd9c409821d"]
}, Open  ]],
Cell[39661, 1180, 4429, 131, 295, "Input",ExpressionUUID->"c154199a-da3e-459e-b950-7d37820399d9"],
Cell[CellGroupData[{
Cell[44115, 1315, 4817, 138, 535, "Input",ExpressionUUID->"9f837ba3-b5b4-435a-ab38-964d60aa0b91"],
Cell[48935, 1455, 224, 5, 41, "Print",ExpressionUUID->"5652ed11-82eb-45c3-a441-8fc04cac6086"]
}, Open  ]],
Cell[49174, 1463, 5351, 158, 333, "Input",ExpressionUUID->"9b4c6cf5-7376-45ce-8a0c-7e330887deca"],
Cell[CellGroupData[{
Cell[54550, 1625, 5154, 147, 535, "Input",ExpressionUUID->"a7580264-4b46-4214-988b-8874c9b92242"],
Cell[59707, 1774, 272, 6, 41, "Print",ExpressionUUID->"0863f9ea-bcdf-4b8b-a3f5-ed50461a9def"]
}, Open  ]],
Cell[59994, 1783, 5847, 174, 371, "Input",ExpressionUUID->"8b006829-da40-4f41-bb31-176e4b87c03b"],
Cell[CellGroupData[{
Cell[65866, 1961, 5027, 144, 516, "Input",ExpressionUUID->"501efd23-3adb-4064-9f35-f1b1293cded9"],
Cell[70896, 2107, 249, 5, 41, "Print",ExpressionUUID->"690ad3f3-2ea0-4c57-ad13-5d9ba0a8e5da"]
}, Open  ]],
Cell[71160, 2115, 5010, 149, 333, "Input",ExpressionUUID->"800da84e-dfd9-4cad-931b-0102d820629c"],
Cell[CellGroupData[{
Cell[76195, 2268, 4947, 143, 535, "Input",ExpressionUUID->"fee83685-b9d6-420e-998e-80741aa3ddef"],
Cell[81145, 2413, 227, 5, 41, "Print",ExpressionUUID->"a71fe4db-dae5-4aaf-bf40-c6bcc31bddaa"]
}, Open  ]],
Cell[81387, 2421, 5597, 165, 352, "Input",ExpressionUUID->"6c2a0814-c4d6-4b62-9bef-aa934a306d3c"],
Cell[CellGroupData[{
Cell[87009, 2590, 5055, 145, 535, "Input",ExpressionUUID->"6fb62891-67ad-418d-846b-6e15a0468aec"],
Cell[92067, 2737, 227, 5, 41, "Print",ExpressionUUID->"8f06159b-a33c-4f66-b914-39ab4aa54a80"]
}, Open  ]],
Cell[92309, 2745, 5878, 175, 371, "Input",ExpressionUUID->"cae2a2dd-4f50-408a-939a-e97502f25355"],
Cell[CellGroupData[{
Cell[98212, 2924, 4976, 143, 516, "Input",ExpressionUUID->"eb0030d6-5f68-486b-b425-b3c96ff818d9"],
Cell[103191, 3069, 227, 5, 41, "Print",ExpressionUUID->"8176031b-676f-4e38-b877-8714f78f789a"]
}, Open  ]]
}
]
*)

